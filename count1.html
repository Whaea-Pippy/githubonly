<!doctype html>
<html lang="en" class="h-full">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Count the Cars & Trucks!</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
body { margin:0; height:100vh; width:100vw; }

.game-background {
  background: linear-gradient(135deg,#87CEEB,#B8E6F2,#D4F4DD,#F0F8D4);
  height:100%;
}

/* ---------- PLAY AREA ---------- */
.play-area {
  border:10px dashed white;
  border-radius:2rem;
  height:100%;
  position:relative;
  overflow:hidden;
  background:rgba(255,255,255,0.1);
}

/* ---------- VEHICLE ---------- */
.vehicle {
  position:absolute;
  width:200px;
  height:120px;
  cursor:pointer;
  filter: drop-shadow(0 6px 14px rgba(0,0,0,0.3));
}

.vehicle-inner {
  width:100%;
  height:100%;
  animation: float 4s ease-in-out infinite alternate;
  transition: transform 0.25s ease;
}

.vehicle:hover .vehicle-inner {
  transform: scale(1.15);
}

.vehicle.counted {
  pointer-events:none;
  opacity:0.5;
}

.vehicle.counted .vehicle-inner {
  animation:none;
}

/* FLOAT without layout shift */
@keyframes float {
  from { transform: translateY(0); }
  to   { transform: translateY(-8px); }
}

/* ---------- BADGE ---------- */
.count-badge {
  position:absolute;
  top:-30px;
  right:-30px;
  width:70px;
  height:70px;
  border-radius:50%;
  background:white;
  font-size:2.5rem;
  font-weight:bold;
  display:none;
  align-items:center;
  justify-content:center;
  border:6px solid #FBBF24;
  box-shadow:0 8px 20px rgba(0,0,0,0.3);
}
</style>
</head>

<body class="game-background flex flex-col">

<header class="text-center py-6">
  <h1 id="title" class="text-5xl md:text-7xl font-black text-white">
    Count the cars & trucks!
  </h1>
  <div id="counter-header" class="text-3xl md:text-5xl text-yellow-300 font-bold mt-4"></div>
</header>

<main class="flex-1 px-4 pb-4">
  <div class="play-area">
    <div id="vehicles-container" class="absolute inset-0"></div>
  </div>
</main>

<script>
let countedVehicles = new Set();
let totalVehicles = Math.floor(Math.random()*6)+3;

const colors = ['#FF6B6B','#FFD93D','#6BCF7F','#4ECDC4','#54A0FF','#FF9FF3'];

document.getElementById("counter-header").textContent = `0 / ${totalVehicles}`;

function createVehicles() {
  const container = document.getElementById("vehicles-container");
  container.innerHTML = "";
  countedVehicles.clear();

  const bounds = container.getBoundingClientRect();
  const VEH_W = 200;
  const VEH_H = 120;
  const SAFE = 240;
  const positions = [];

  for(let i=0;i<totalVehicles;i++){
    let pos,tries=0;
    do {
      pos = {
        x: Math.random() * (bounds.width - VEH_W),
        y: Math.random() * (bounds.height - VEH_H)
      };
      tries++;
    } while (
      positions.some(p => Math.hypot(p.x-pos.x, p.y-pos.y) < SAFE)
      && tries < 500
    );

    positions.push(pos);

    const v = document.createElement("div");
    v.className = "vehicle";
    v.style.left = pos.x + "px";
    v.style.top = pos.y + "px";

    const c = colors.sort(()=>Math.random()-0.5);

    v.innerHTML = `
      <div class="vehicle-inner">
        <svg width="200" height="120" viewBox="0 0 100 60">
          <rect x="10" y="25" width="80" height="20" rx="8" fill="${c[0]}"/>
          <circle cx="25" cy="50" r="10" fill="#333"/>
          <circle cx="75" cy="50" r="10" fill="#333"/>
        </svg>
      </div>
      <div class="count-badge"></div>
    `;

    v.onclick = () => {
      if (countedVehicles.has(i)) return;
      countedVehicles.add(i);
      v.classList.add("counted");

      const b = v.querySelector(".count-badge");
      b.textContent = countedVehicles.size;
      b.style.display = "flex";

      document.getElementById("counter-header").textContent =
        `${countedVehicles.size} / ${totalVehicles}`;
    };

    container.appendChild(v);
  }
}

createVehicles();
</script>

</body>
</html>

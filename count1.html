<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Count the Cars & Trucks!</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
html, body {
  margin: 0;
  height: 100%;
  overflow: hidden;
}
body {
  background: linear-gradient(135deg, #87CEEB, #B8E6F2, #D4F4DD, #F0E8D4);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}
/* Vehicle visuals */
.vehicle svg {
  width: clamp(90px, 18vw, 160px);
  height: auto;
  transition: transform 0.25s ease;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
}
.vehicle:hover svg {
  transform: scale(1.15) translateY(-6px);
}
.vehicle.counted {
  opacity: 0.4;
  pointer-events: none;
}
/* Count badge */
.count-badge {
  position: absolute;
  top: -12px;
  right: -12px;
  width: 50px;
  height: 50px;
  background: white;
  border-radius: 999px;
  display: none;
  align-items: center;
  justify-content: center;
  font-weight: 900;
  font-size: 1.4rem;
  border: 4px solid #FBBF24;
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
}
</style>
</head>
<body>
<div class="h-full flex flex-col px-4 pt-4">
  <!-- Header -->
  <div class="flex items-center justify-between mb-3">
    <h1 class="text-3xl md:text-4xl font-black text-white drop-shadow-lg">Count the Cars & Trucks!</h1>
    <div id="counter" class="text-2xl md:text-3xl font-black bg-white px-6 py-3 rounded-full shadow-lg">
      0 / 0
    </div>
  </div>
  <!-- Play Area -->
  <div id="play-area"
       class="flex-1 border-8 border-white/70 rounded-3xl bg-white/20 shadow-inner
              grid place-items-center overflow-hidden">
    <div id="grid"
         class="w-full h-full grid place-items-center gap-8 px-6 py-6">
    </div>
  </div>
</div>
<!-- Completion Modal -->
<div id="completion"
     class="hidden fixed inset-0 flex items-center justify-center bg-black/40 z-50">
  <div class="bg-gradient-to-br from-emerald-500 to-green-600 text-white px-12 py-12 rounded-3xl shadow-2xl text-center max-w-md w-full mx-4">
    <p id="completion-text" class="text-3xl md:text-4xl font-black mb-8"></p>
    <button onclick="resetGame()"
            class="bg-white/30 hover:bg-white/40 px-10 py-4 rounded-full text-xl font-black transition transform hover:scale-105">
      Play Again ▶
    </button>
  </div>
</div>
<script>
let total = 0;
let lastTotal = null;
let counted = new Set();
const colors = [
  "#FF6B6B","#FFD93D","#6BCF7F","#4ECDC4",
  "#54A0FF","#FF9FF3","#FF8A65","#7FDBFF"
];

function speak(n){
  if(!("speechSynthesis" in window)) return;
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(n.toString());
  u.rate = 0.85;
  u.pitch = 1.1;
  speechSynthesis.speak(u);
}

function pickTotal(){
  let n;
  do {
    n = Math.floor(Math.random()*7)+4; // 4–10 vehicles
  } while (n === lastTotal);
  lastTotal = n;
  return n;
}

function render(){
  counted.clear();
  total = pickTotal();
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  document.getElementById("counter").textContent = `0 / ${total}`;

  const area = document.getElementById("play-area").getBoundingClientRect();
  const size = Math.min(Math.max(window.innerWidth * 0.18, 90), 160);
  const cols = Math.max(2, Math.floor(area.width / (size + 40)));
  grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

  for(let i = 0; i < total; i++){
    const v = document.createElement("div");
    v.className = "vehicle relative cursor-pointer";
    const color = colors[Math.floor(Math.random() * colors.length)];

    v.innerHTML = `
      <svg viewBox="0 0 120 70">
        <!-- Car body -->
        <rect x="15" y="20" width="90" height="30" rx="12" fill="${color}"/>
        <!-- Cab window (for trucks sometimes) -->
        <rect x="80" y="12" width="30" height="20" rx="6" fill="${color}" opacity="0.7"/>
        <!-- Wheels -->
        <circle cx="30" cy="55" r="12" fill="#212529"/>
        <circle cx="90" cy="55" r="12" fill="#212529"/>
        <!-- Windows -->
        <rect x="25" y="25" width="35" height="18" rx="4" fill="#1E293B" opacity="0.6"/>
        <rect x="65" y="25" width="35" height="18" rx="4" fill="#1E293B" opacity="0.6"/>
      </svg>
      <div class="count-badge"></div>
    `;

    v.onclick = () => {
      if(counted.has(i)) return;
      counted.add(i);
      v.classList.add("counted");
      const badge = v.querySelector(".count-badge");
      badge.textContent = counted.size;
      badge.style.display = "flex";
      document.getElementById("counter").textContent = `${counted.size} / ${total}`;
      speak(counted.size);

      if(counted.size === total){
        setTimeout(showCompletion, 600);
      }
    };
    grid.appendChild(v);
  }
}

function showCompletion(){
  document.getElementById("completion-text").textContent = `Great job! There are ${total} vehicles!`;
  document.getElementById("completion").classList.remove("hidden");
  speak(total);
}

function resetGame(){
  document.getElementById("completion").classList.add("hidden");
  render();
}

window.addEventListener("resize", render);
render();
</script>
</body>
</html>

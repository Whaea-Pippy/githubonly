<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Strength — 25 min</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Poppins, Arial, sans-serif;
  margin: 0;
  padding: 10px;
  background: #f8f8f8;
  color: #333;
}
h1 {
  font-size: 26px;
  text-align: center;
  margin-bottom: 12px;
  font-weight: 700;
}
.exercise {
  background: #fff;
  padding: 16px;
  border-radius: 14px;
  margin-bottom: 14px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}
.name { font-size: 20px; font-weight: 700; margin-bottom: 4px; }
.desc { font-size: 16px; margin-bottom: 8px; color: #555; }
.timer {
  font-size: 28px;
  font-weight: 600;
  text-align: center;
  margin-bottom: 8px;
}
.bar-wrap {
  width: 100%;
  height: 18px;
  background: #e8e8e8;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 10px;
}
.bar {
  width: 0%;
  height: 100%;
  background: #4caf50;
  transition: width 1s linear;
}
button {
  width: 100%;
  font-size: 18px;
  padding: 10px;
  border: none;
  border-radius: 10px;
  margin-bottom: 4px;
  background: #4caf50;
  color: white;
}
button:disabled { background: #aaa; }
.done {
  font-size: 18px;
  font-weight: 700;
  color: #2d7d1f;
  text-align: center;
  margin-top: 6px;
}
.history-box {
  background: #fff;
  padding: 14px;
  border-radius: 14px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  margin-top: 20px;
}
.history-entry {
  font-size: 16px;
  border-bottom: 1px solid #ddd;
  padding: 6px 0;
}
.weekly-entry {
  font-size: 16px;
  border-bottom: 1px solid #ddd;
  padding: 6px 0;
  font-weight: 700;
}
.complete-box {
  background: #fff;
  padding: 16px;
  border-radius: 14px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  margin-top: 14px;
  text-align: center;
}
.save-btn {
  background: #8e44ad;
  margin-top: 10px;
  font-size: 18px;
}
</style>
</head>
<body>

<h1>Strength — 25 min</h1>

<div id="exerciseContainer"></div>
<div id="sessionComplete"></div>

<div class="history-box">
  <h2>Daily History</h2>
  <div id="historyList"></div>
</div>

<div class="history-box">
  <h2>Weekly History (Monday Start)</h2>
  <div id="weeklyHistory"></div>
</div>

<script>

const STORAGE_KEY = "strong1History";

const exercises = [
  {name:"Breathe",time:60,desc:"Warm-up — slow breathing"},
  {name:"Deep Squat",time:300,desc:"Sit deep, chest lifted, heels down"},
  {name:"Squats",time:120,desc:"Slow controlled reps"},
  {name:"Reverse Lunges",time:120,desc:"Step back, balance + glutes"},
  {name:"Side Lunges",time:120,desc:"Inner thigh + hips"},
  {name:"Push-Ups (Wall/Counter)",time:120,desc:"Arms + chest"},
  {name:"Plank",time:120,desc:"Brace core + breathe"},
  {name:"Glute Bridge",time:120,desc:"Glutes + low back"},
  {name:"Hip Abduction",time:120,desc:"Fall-prevention & hips"},
  {name:"Calf Raises",time:120,desc:"Ankles + balance"},
  {name:"Down-Dog → Plank",time:120,desc:"Strength + mobility"},
  {name:"Breathe",time:60,desc:"Cool-down — slow breathing"}
];

let completedCount = 0;
const totalExercises = exercises.length;

function format(sec){
  const m=Math.floor(sec/60);
  const s=String(sec%60).padStart(2,"0");
  return `${m}:${s}`;
}

function formatDisplayDate(iso){
  const [y,m,d] = iso.split("-");
  return `${d}/${m}/${y}`;
}

function getMondayFromISO(iso){
  const [y,m,d] = iso.split("-");
  const date = new Date(y, m-1, d);
  const day = date.getDay();
  const diff = date.getDate() - (day === 0 ? 6 : day - 1);
  date.setDate(diff);
  return date.toISOString().split("T")[0];
}

function allCompleted(){
  return completedCount === totalExercises;
}

function render(){
  const container=document.getElementById("exerciseContainer");
  container.innerHTML="";
  exercises.forEach((ex,i)=>{
    const div=document.createElement("div");
    div.className="exercise";
    div.innerHTML=`
      <div class="name">${ex.name}</div>
      <div class="desc">${ex.desc}</div>
      <div class="timer" id="timer-${i}">${format(ex.time)}</div>
      <div class="bar-wrap"><div id="bar-${i}" class="bar"></div></div>
      <button id="start-${i}" onclick="startTimer(${i})">Start</button>
      <div id="done-${i}" class="done" style="display:none;">Done ✔</div>
    `;
    container.appendChild(div);
  });
}

function startTimer(i){
  const ex = exercises[i];
  let remaining = ex.time;
  const btn = document.getElementById(`start-${i}`);
  btn.disabled = true;

  const timerEl = document.getElementById(`timer-${i}`);
  const barEl = document.getElementById(`bar-${i}`);

  const interval = setInterval(()=>{
    remaining--;
    timerEl.textContent = format(remaining);
    const pct = ((ex.time-remaining)/ex.time)*100;
    barEl.style.width = pct+"%";

    if(remaining <= 0){
      clearInterval(interval);
      markDone(i);
    }
  },1000);
}

function markDone(i){
  document.getElementById(`done-${i}`).style.display = "block";
  completedCount++;
  if(allCompleted()){
    showCompleteBox();
  }
}

function showCompleteBox(){
  const box=document.getElementById("sessionComplete");
  box.innerHTML = `
   <div class="complete-box">
    <div style="font-size:22px;font-weight:700;">Session Complete!</div>
    <div style="font-size:18px;margin-top:6px;">Total: 25 min</div>
    <button id="saveBtn" class="save-btn" onclick="saveDay()">Save Day</button>
   </div>
  `;
  initSaveBtn();
}

function saveDay() {
  if (!allCompleted()) return;

  const todayISO = new Date().toISOString().split("T")[0];
  const hist = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

  if (!hist.some(h => h.date === todayISO)) {
    hist.push({date: todayISO, minutes: 25});
    localStorage.setItem(STORAGE_KEY, JSON.stringify(hist));
  }

  const btn = document.getElementById("saveBtn");
  btn.textContent = "Day Saved";
  btn.disabled = true;

  loadHistory();
}

function loadHistory(){
  const hist = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

  // DAILY DISPLAY
  const list=document.getElementById("historyList");
  list.innerHTML = hist
    .sort((a,b)=>b.date.localeCompare(a.date))
    .map(h => `
      <div class="history-entry">
        ${formatDisplayDate(h.date)} — ${h.minutes} min ✔
      </div>
    `).join("");

  // WEEKLY TOTALS
  const weeklyContainer=document.getElementById("weeklyHistory");
  const weeks={};

  hist.forEach(h=>{
    const mondayISO=getMondayFromISO(h.date);
    if(!weeks[mondayISO]) weeks[mondayISO]=0;
    weeks[mondayISO]+=h.minutes;
  });

  weeklyContainer.innerHTML = Object.keys(weeks)
    .sort((a,b)=>b.localeCompare(a))
    .map(k=>`
      <div class="weekly-entry">
        Week starting Monday ${formatDisplayDate(k)} — ${weeks[k]} min
      </div>
    `).join("");
}

function initSaveBtn(){
  const hist = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  const todayISO = new Date().toISOString().split("T")[0];
  const btn=document.getElementById("saveBtn");
  if(btn && hist.some(h => h.date === todayISO)){
    btn.textContent = "Day Saved";
    btn.disabled = true;
  }
}

render();
loadHistory();
</script>

</body>
</html>
